
<!--<!DOCTYPE html>-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
	<link rel="icon" href="https://lh3.googleusercontent.com/vUVAL5IZJl_9MsS7PQcWotUqinlSEIW_VllIN32y9zZcKH_XVTS1ZtGPgbFRxE42IsSS=w300">


		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
	
		<script type="text/javascript" src="js/fusioncharts.js"></script>
		<script type="text/javascript" src="js/themes/fusioncharts.theme.ocean.js"></script>

  		<title>Wetterstation Mauve</title>
	
		<meta name="author" content="Furkan&amp;Johann" />
		<meta name="description" content="Wetterstation - Ein Schulprojekt des CHG mit Unterstützung von Mauve" />
		<meta name="viewport" content="width=device-width, initial-scale=0.75">

		<link rel="stylesheet" type="text/css" media="screen and (min-device-width: 320px) and (max-device-width: 500px)" href="stylesheetmobile.css" />
		<link rel="stylesheet" type="text/css" media="screen and (min-device-width: 501px)" href="stylesheet.css" />	
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

</head>
<body>

	<div id="page" class="container-fluid">
		<div id="logo">
			<img id="imglogo" src="banner.png" alt="Wetterstation Mauve">
		</div>
		<div class="nav" style="margin-top: 10px;">
			<ul>
				<li><a href="index.php">Home</a></li>
				<li><a target="_blank" href="https://www.mauve.eu/today-is-newsday-01-2018-sch%C3%BCler-messen-feinstaub-mit-selbst-programmierter-wetterstation.html">Über uns</a></li>
				<li><a href="mailto:wetterstationmauve@gmail.de">Kontakt</a></li>
			</ul>	
		</div>
		<div id="content">
			<h2>Home</h2>
			<p>Willkommen auf unserer Website. Hier präsentieren wir Ihnen unsere Ergebnisse zum Projekt <b style="color: #aa0000;">"Wetterstation Mauve"</b>.</p>
			<p>In diesem Projekt haben drei Schüler des CHG eine Wetterstation innerhalb von drei Tagen gebaut und programmiert.</p>
		</div>
    	<div id="megadiv">
			<div id="values" class="column">
				<h2 style="margin-top: 10px; font-size: 18pt;"><u>Aktuelle Werte</u></h2>

				<p>
				<?php

				include 'sql.php';
				include 'curl.php';

				$json = loadJSON('https://api.opensensemap.org/boxes/5a699afe411a790019628c13/sensors');
				$pm10 = $json['sensors'][0]['lastMeasurement']['value'];
				$pm2p5 = $json['sensors'][1]['lastMeasurement']['value'];
				$temperature = $json['sensors'][2]['lastMeasurement']['value'];
				$humidity = $json['sensors'][3]['lastMeasurement']['value'];	

				$oldTimestamp = $timestamp;
				$time = $json['sensors'][0]['lastMeasurement']['createdAt'];
				$time = new \DateTime($time);
				$timestamp = $time->getTimestamp();



				//printCurrentData($timestamp, $temperature, $humidity, $pm10, $pm2p5, "<br/>");
				echo '<p class="indentifier">Zeit: </p><p class="value">'.date('Y-m-d H:i:s', $timestamp).'</p><br>';
				echo '<p class="indentifier">Temperatur: </p><p class="value">'.$temperature."°C".'</p><br>';
				echo '<p class="indentifier">rel. Luftfeuchigkeit: </p><p class="value">'.$humidity."%".'</p><br>';
				echo '<p class="indentifier">Feinstaub (PM10): </p><p class="value">'.$pm10."µg/cm³".'</p><br>';
				echo '<p class="indentifier">Feinstaub (PM2.5): </p><p class="value">'.$pm2p5."µg/cm³".'</p><br>';

				?>
				</p>
			</div> 
      		<div id="graphs" class="column">
				<div class="dropdown">
					<button class="dropbtn">Zeitdauer</button>
					<div class="dropdown-content">
						<form method="post">
						<button type="submit" name="test" value="86400" id="dropdownbutton">1 Tag</button>
						<button type="submit" name="test" value="604800" id="dropdownbutton">1 Woche</button>
						<button type="submit" name="test" value="31536000" id="dropdownbutton">1 Jahr</button>
						<button type="submit" name="test" value="1000000000000000" id="dropdownbutton">Unbegrenzt</button>
						</form>
					</div>
				</div>
				
        		<div id="graphs1"></div>
				<h2>------------------------------------------------------------</h2>
				<div id="graphs2"></div>
				<h2>------------------------------------------------------------</h2>
				<div id="graphs3">
					<div id="graphs31">
					</div>
					<div id="graphs32">
					</div>
				</div>
			</div> 
			
			<div id="page-wrap" class="column">
			</div>
				
		</div>
			
		<div id="footer">
			<p>Webpage made by <a href="/" target="_blank">Furkan Gedikoglu &amp; Johann Jakob Hellermann</a></p>
		</div>
	</div>
</body>
</html>

<?php

include_once("sql.php");
include_once("graphs.php");

$seconds = 100000000000000000;



if (array_key_exists("test", $_POST)){
     $seconds = $_POST["test"];
}

$conn = connectToDatabase("localhost", "pi", "burgerking", "wetterstation");

graph($conn, "Temperature", "Temperature", "Temperatur", "100%", "300", "graphs1", $seconds);
graph($conn, "Humidity", "Humidity", "rel. Luftfeuchtigkeit", "100%", "300", "graphs2", $seconds);
graph($conn, "Pollutants", "PollutantPM10", "Feinstaub (PM10)", "100%", "300", "graphs32", $seconds);
graph($conn, "Pollutants", "PollutantPM2p5", "Feinstaub (PM2.5)", "100%", "300", "graphs31", $seconds);



?>








































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































